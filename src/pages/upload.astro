---
import Container from '../components/Container.astro';
import Badge from '../components/Badge.astro';
import Panel from '../components/Panel.astro';
import TallyInline from '../components/TallyInline.astro';
import AnalyticsPlausible from '../components/AnalyticsPlausible.astro';
import '../styles/global.css';

const title = "Upload Stats - PT Authority Hub";
const statsFormId = import.meta.env.PUBLIC_TALLY_STATS_FORM_ID || "pbyXyJ";
---

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{title}</title>
  <AnalyticsPlausible />
</head>
<body class="selection:bg-accent selection:text-bg min-h-screen bg-bg">
  <main class="py-12 sm:py-24">
    <Container>
      <div class="max-w-3xl mx-auto space-y-16">
        
        <!-- Header Section -->
        <div class="text-center">
          <Badge variant="muted" className="mb-4">Optional: Audit precision</Badge>
          <h1 class="text-3xl sm:text-5xl font-bold text-text mb-6 leading-tight">
            Optional: Upload your 30-day summary
          </h1>
          <p class="text-muted text-lg max-w-2xl mx-auto">
            This helps me make your audit more precise. You still receive your Performance Audit within 24 hours regardless.
          </p>
        </div>

        <!-- What to Upload -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-start">
          <div class="space-y-6">
            <h2 class="text-xl font-bold text-text">What to upload</h2>
            <ul class="space-y-4">
              <li class="flex items-start gap-3 text-muted leading-relaxed">
                <span class="text-accent">✓</span>
                <span>Apple Watch / Apple Health summaries (screenshots or export)</span>
              </li>
              <li class="flex items-start gap-3 text-muted leading-relaxed">
                <span class="text-accent">✓</span>
                <span>Oura / WHOOP / Garmin monthly or weekly report screenshots</span>
              </li>
              <li class="flex items-start gap-3 text-muted leading-relaxed">
                <span class="text-accent">✓</span>
                <span>PDF export if available</span>
              </li>
            </ul>
            <p class="text-xs text-muted2 italic pt-2">
              Note: Please do not upload medical documents.
            </p>
          </div>

          <!-- Embed Section -->
          <div class="space-y-4">
            <label class="block text-xs font-bold text-accent uppercase tracking-widest">Upload form</label>
            <Panel className="p-1 border-white/5 bg-panel shadow-2xl relative">
              <TallyInline 
                formId={statsFormId} 
                title="Upload Your Stats" 
                height={550} 
                params="alignLeft=1&hideTitle=1&transparentBackground=1&dynamicHeight=1"
              />
            </Panel>
            <div class="flex flex-col gap-2">
              <p class="text-[10px] text-muted2">If the form does not load, use the direct link below:</p>
              <a href="https://tally.so/r/pbyXyJ" target="_blank" rel="noopener noreferrer" class="text-xs text-accent hover:underline">
                https://tally.so/r/pbyXyJ
              </a>
            </div>
          </div>
        </div>

        <!-- How it's used & Disclaimer -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 pt-8 border-t border-white/5">
          <div class="space-y-4">
            <h2 class="text-xl font-bold text-text">How your upload is used</h2>
            <ul class="space-y-3">
              <li class="flex items-start gap-2 text-sm text-muted2">
                <span class="text-accent">•</span>
                <span>Used only to prepare your Performance Audit.</span>
              </li>
              <li class="flex items-start gap-2 text-sm text-muted2">
                <span class="text-accent">•</span>
                <span>Deleted automatically from our systems within 30 days.</span>
              </li>
              <li class="flex items-start gap-2 text-sm text-muted2">
                <span class="text-accent">•</span>
                <span>Contact <a href="mailto:privacy@pt-authority.hub" class="text-accent hover:underline">privacy@pt-authority.hub</a> for manual deletion requests.</span>
              </li>
            </ul>
          </div>
          <div class="space-y-4">
            <h2 class="text-xl font-bold text-text">Disclaimer</h2>
            <p class="text-sm text-muted2 leading-relaxed">
              Our analysis is professional coaching advice, not medical clinical guidance. Please consult your physician before making significant changes to your activity levels or nutrition.
            </p>
          </div>
        </div>

        <!-- What happens next -->
        <div class="bg-panel border border-white/5 rounded-2xl p-8 sm:p-12 text-center space-y-8">
          <h2 class="text-2xl font-bold text-text">What happens next</h2>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            <div class="space-y-2">
              <div class="text-accent font-bold text-lg">01</div>
              <p class="text-sm text-muted">I review your upload along with your quiz results.</p>
            </div>
            <div class="space-y-2">
              <div class="text-accent font-bold text-lg">02</div>
              <p class="text-sm text-muted">You receive your personalized audit by email within 24 hours.</p>
            </div>
            <div class="space-y-2">
              <div class="text-accent font-bold text-lg">03</div>
              <p class="text-sm text-muted">If you want to go faster, follow the instructions in the audit email.</p>
            </div>
          </div>
        </div>

        <!-- Footer Link -->
        <div class="text-center pt-8">
          <a href="/quiz" class="text-xs text-muted2 hover:text-accent uppercase tracking-widest font-mono transition-colors">
            ← Back to quiz
          </a>
        </div>

      </div>
    </Container>
  </main>

  <script is:inline>
    (function () {
      var d = document;
      var w = "https://tally.so/widgets/embed.js";

      function v() {
        if (typeof Tally !== "undefined") {
          Tally.loadEmbeds();
          return;
        }
        d.querySelectorAll("iframe[data-tally-src]:not([src])").forEach(function (e) {
          e.src = e.dataset.tallySrc;
        });
      }

      if (typeof Tally !== "undefined") {
        v();
        return;
      }

      if (d.querySelector('script[src="' + w + '"]') == null) {
        var s = d.createElement("script");
        s.src = w;
        s.onload = v;
        s.onerror = v;
        d.body.appendChild(s);
      }
    })();
  </script>
</body>
</html>
