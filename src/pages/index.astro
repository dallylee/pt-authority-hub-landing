---
import TallyEmbed from '../components/TallyEmbed.astro';
import Testimonials from '../components/Testimonials.astro';
import BookingCTA from '../components/BookingCTA.astro';
import AnalyticsPlausible from '../components/AnalyticsPlausible.astro';
import Container from '../components/Container.astro';
import Panel from '../components/Panel.astro';
import Badge from '../components/Badge.astro';
import MiniMetric from '../components/MiniMetric.astro';
import offer from '../data/offer.json';
import '../styles/global.css';

const title = "PT Authority Hub - Your Personal Fitness Coach";
const description = "Get a Custom Training Plan in 24 Hours. Professional coaching for serious results.";
const canonicalURL = "https://pt-authority-hub-landing.pages.dev";

const quizFormId = import.meta.env.PUBLIC_TALLY_QUIZ_FORM_ID || "OD4eKp";
const statsFormId = import.meta.env.PUBLIC_TALLY_STATS_FORM_ID || "pbyXyJ";
---

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{title}</title>
  <meta name="description" content={description} />
  <link rel="canonical" href={canonicalURL} />
  
  <!-- Open Graph / Social Media -->
  <meta property="og:title" content={title} />
  <meta property="og:description" content={description} />
  <meta property="og:type" content="website" />
  <meta property="og:url" content={canonicalURL} />
  
  <AnalyticsPlausible />
</head>
<body class="selection:bg-accent selection:text-bg">
  
  <!-- Skip to content link for accessibility -->
  <a href="#content" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:px-4 focus:py-2 focus:bg-blue-600 focus:text-white focus:rounded">
    Skip to main content
  </a>
  
  <!-- Hero Section -->
  <section id="hero" class="min-h-screen flex items-center pt-24 pb-16 overflow-hidden relative">
    <!-- Subtle Background Glow -->
    <div class="absolute top-1/2 right-0 -translate-y-1/2 w-[500px] h-[500px] bg-accent/5 blur-[120px] rounded-full pointer-events-none"></div>
    
    <Container className="relative z-10">
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 lg:gap-20 items-center">
        <!-- Left: Copy -->
        <div class="text-left flex flex-col justify-center">
          <h1 class="text-4xl sm:text-5xl md:text-6xl font-bold mb-6 leading-[1.1] tracking-tight text-text">
            Stop Guessing. <br class="hidden sm:block" />
            Start Progressing. <br class="hidden sm:block" />
            Get Your <span class="text-accent">Data-Driven</span> Training Plan.
          </h1>
          <p class="text-xl sm:text-2xl text-muted mb-8 max-w-xl font-medium">
            Get a Custom Training Plan in 24 Hours.
          </p>
          
          <div class="flex flex-col items-start gap-4 mb-10">
            <a href="#quiz" class="inline-flex items-center justify-center bg-accent text-bg px-10 py-5 rounded-lg text-xl font-bold hover:brightness-110 transition-all transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-accent focus:ring-offset-2 focus:ring-offset-bg min-h-[60px] plausible-event-name=Start+Free+Audit">
              Start Free Audit
            </a>
            <p class="text-sm text-muted2 ml-2">No credit card required</p>
          </div>

          <div class="flex items-center gap-4 py-4 px-6 bg-panel/30 border border-white/5 rounded-2xl w-fit">
            <div class="flex -space-x-2">
              {[1,2,3].map(() => (
                <div class="w-8 h-8 rounded-full border-2 border-bg bg-panel flex items-center justify-center overflow-hidden">
                  <div class="w-full h-full bg-muted/20"></div>
                </div>
              ))}
            </div>
            <div class="text-sm">
              <span class="text-accent font-bold">⭐⭐⭐⭐⭐</span>
              <span class="text-muted block text-xs">Rated 4.9/5 by 200+ clients</span>
            </div>
          </div>
        </div>

        <!-- Right: PT Profile + Dashboard -->
        <div class="relative space-y-6">
          <!-- PT Profile Card -->
          <Panel className="border-accent/10 bg-panel/80 backdrop-blur-sm p-6 flex items-center gap-6">
            <div class="w-20 h-20 rounded-2xl bg-muted/20 overflow-hidden flex-shrink-0 border border-white/5">
              <img src="/coach.jpg" alt="Coach" class="w-full h-full object-cover opacity-50" onerror="this.style.display='none'" />
            </div>
            <div>
              <p class="text-xs font-bold text-accent uppercase tracking-widest mb-1">Lead Coach</p>
              <h3 class="text-xl font-bold text-text">Coach Name (TODO)</h3>
              <p class="text-xs text-muted2">Signal Analyst & Performance Specialist</p>
            </div>
          </Panel>

          <ul class="hidden lg:grid grid-cols-2 gap-3 opacity-50">
            <li class="flex items-center gap-2 text-[10px] text-muted2 uppercase tracking-widest">
              <span class="text-accent">/</span> 30-day Data Analysis
            </li>
            <li class="flex items-center gap-2 text-[10px] text-muted2 uppercase tracking-widest">
              <span class="text-accent">/</span> Personalized Roadmap
            </li>
            <li class="flex items-center gap-2 text-[10px] text-muted2 uppercase tracking-widest">
              <span class="text-accent">/</span> Professional Coaching
            </li>
            <li class="flex items-center gap-2 text-[10px] text-muted2 uppercase tracking-widest">
              <span class="text-accent">/</span> Remote Optimization
            </li>
          </ul>
        </div>

        <!-- Right: Dashboard Preview -->
        <div class="relative">
          <Panel className="border-accent/10 bg-panel/80 backdrop-blur-sm">
            <h3 class="text-xs font-bold text-muted2 uppercase tracking-[0.2em] mb-8">Performance Snapshot</h3>
            <div class="grid grid-cols-2 gap-4">
              <MiniMetric label="Sleep" value="94%" note="CONSISTENT" />
              <MiniMetric label="Load" value="1.2" note="OPTIMAL" />
              <MiniMetric label="Recovery" value="88" note="READY" />
              <MiniMetric label="Movement" value="12k" note="DAILY AVG" />
            </div>
            
            <div class="mt-8 pt-8 border-t border-white/5">
              <div class="flex items-center justify-between mb-2">
                <span class="text-xs text-muted2 uppercase">Current Signal Strength</span>
                <span class="text-xs text-accent">High</span>
              </div>
              <div class="w-full h-1 bg-white/5 rounded-full overflow-hidden">
                <div class="w-3/4 h-full bg-accent shadow-[0_0_10px_rgba(166,255,0,0.5)]"></div>
              </div>
            </div>
          </Panel>
          
          <!-- Decorative element -->
          <div class="absolute -bottom-6 -left-6 w-24 h-24 border-b-2 border-l-2 border-accent/20 rounded-bl-3xl -z-10"></div>
        </div>
      </div>
    </Container>
  </section>
  
  <!-- Main Content -->
  <main id="content">

  <!-- Trust Logos Section -->
  <section id="trust-logos" class="py-12 border-y border-white/5 bg-bg2/30">
    <Container>
      <div class="grid grid-cols-2 lg:grid-cols-4 gap-8 opacity-40 grayscale hover:grayscale-0 transition-all">
        <div class="flex items-center justify-center h-12 border border-white/5 rounded-lg bg-panel/50">
          <p class="text-[10px] uppercase tracking-widest text-muted2 font-mono">Elite Performance</p>
        </div>
        <div class="flex items-center justify-center h-12 border border-white/5 rounded-lg bg-panel/50">
          <p class="text-[10px] uppercase tracking-widest text-muted2 font-mono">Signal Analysis</p>
        </div>
        <div class="flex items-center justify-center h-12 border border-white/5 rounded-lg bg-panel/50">
          <p class="text-[10px] uppercase tracking-widest text-muted2 font-mono">Clinical Protocol</p>
        </div>
        <div class="flex items-center justify-center h-12 border border-white/5 rounded-lg bg-panel/50">
          <p class="text-[10px] uppercase tracking-widest text-muted2 font-mono">Metric Tracking</p>
        </div>
      </div>
    </Container>
  </section>

  <!-- Mechanism Section -->
  <section id="how-it-works" class="py-24">
    <Container>
      <h2 class="text-xs font-bold text-accent uppercase tracking-[0.3em] mb-12 text-center">Process Architecture</h2>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <Panel title="Step 01: Tell Us About You" className="text-left">
          <p class="text-muted leading-relaxed">Share your goals and fitness level in our 5-minute intake protocol.</p>
        </Panel>
        <Panel title="Step 02: We Build Your Plan" className="text-left">
          <p class="text-muted leading-relaxed">Our coaches analyze your data and create your personalized program within 24 hours.</p>
        </Panel>
        <Panel title="Step 03: Start Training" className="text-left">
          <p class="text-muted leading-relaxed">Follow your tailored workouts and start seeing measurable progress by Day 2.</p>
        </Panel>
      </div>
    </Container>
  </section>

  <!-- Pain & Value Bridge Section -->
  <section id="pain-value-bridge" class="py-24 bg-bg2/50 relative">
    <Container>
      <Panel className="max-w-4xl mx-auto overflow-hidden">
        <div class="grid grid-cols-1 md:grid-cols-2 divide-y md:divide-y-0 md:divide-x divide-white/5">
          <div class="p-8 md:p-12">
            <h3 class="text-xs font-bold text-muted uppercase tracking-widest mb-8">Common Performance Problems</h3>
            <ul class="space-y-4">
              <li class="flex items-start gap-3 text-muted2 text-sm italic">
                <span>—</span> Not seeing results despite working out regularly?
              </li>
              <li class="flex items-start gap-3 text-muted2 text-sm italic">
                <span>—</span> Confused about what to eat and when?
              </li>
              <li class="flex items-start gap-3 text-muted2 text-sm italic">
                <span>—</span> Tired all the time even though you're "healthy"?
              </li>
            </ul>
          </div>
          <div class="p-8 md:p-12 bg-white/[0.02]">
            <h3 class="text-xs font-bold text-accent uppercase tracking-widest mb-8">Clinical Resolution</h3>
            <ul class="space-y-4">
              <li class="flex items-start gap-2 text-text text-sm font-medium">
                <span class="text-accent">✓</span> Evidence-led recovery protocols
              </li>
              <li class="flex items-start gap-2 text-text text-sm font-medium">
                <span class="text-accent">✓</span> Signal-based load management
              </li>
              <li class="flex items-start gap-2 text-text text-sm font-medium">
                <span class="text-accent">✓</span> Deterministic 30-day roadmap
              </li>
            </ul>
          </div>
        </div>
      </Panel>
    </Container>
  </section>

  <!-- Quiz Section -->
  <section id="quiz" class="py-24 bg-bg2/30">
    <Container>
      <div class="max-w-2xl mx-auto">
        <!-- Next steps hint -->
        <div class="mb-12 text-center">
          <Badge variant="accent" className="mb-4">Step 1 of 2</Badge>
          <h2 class="text-3xl font-bold text-text mb-4">Tell Us About You</h2>
          <p class="text-muted">Complete the intake protocol (5 minutes) to secure your 24h turnaround.</p>
          <div class="mt-6">
            <a href="#stats" class="text-xs text-accent uppercase tracking-widest hover:underline">Optional: Upload your stats →</a>
          </div>
        </div>

        <div class="bg-panel border border-white/5 rounded-xl overflow-hidden p-1 shadow-2xl">
          <TallyEmbed 
            formId={quizFormId}
            title="Intake Protocol"
            height={650}
          />
        </div>
      </div>
    </Container>
  </section>

  <!-- Stats Section -->
  <section id="stats" class="py-24 border-y border-white/5 bg-bg2/10 plausible-event-name=View+Stats+Upload">
    <Container>
      <div class="max-w-2xl mx-auto">
        <div class="flex justify-center mb-6">
          <Badge variant="muted">Optional but recommended</Badge>
        </div>
        <p class="text-center text-lg text-muted mb-6">
          Sync your 30-day performance data for a 
          <strong class="text-text">Custom Training Plan in 24 Hours</strong>.
        </p>
        <div class="text-center mb-12">
          <a href="#quiz" class="text-xs text-accent uppercase tracking-widest hover:underline">← Back to Step 1</a>
        </div>
        
        <div class="bg-panel border border-white/5 rounded-xl overflow-hidden p-1 mb-12 shadow-2xl">
          <TallyEmbed 
            formId={statsFormId}
            title="Signal Integration (Optional)"
            height={700}
          />
        </div>
        
        <!-- Consent and Disclaimer -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div class="bg-bg2/50 border border-white/5 rounded-lg p-5">
            <h4 class="text-[10px] font-bold text-muted2 uppercase tracking-widest mb-2">Protocol Consent</h4>
            <p class="text-[11px] text-muted2 leading-relaxed uppercase tracking-tight">
              By submitting, you consent to sharing signals for analysis. Data is purged from all systems within 30 days of delivery.
            </p>
          </div>
          
          <div class="bg-bg2/50 border border-white/5 rounded-lg p-5">
            <h4 class="text-[10px] font-bold text-muted2 uppercase tracking-widest mb-2">Clinical Boundary</h4>
            <p class="text-[11px] text-muted2 leading-relaxed uppercase tracking-tight">
              Analysis provided is high-performance coaching protocol, not medical clinical advice. Consult your physician.
            </p>
          </div>
        </div>
      </div>
    </Container>
  </section>

  <!-- Reviews Section -->
  <Testimonials />
  
  <!-- Pricing Section -->
  <section id="pricing" class="py-24 bg-bg2/50">
    <Container>
      <div class="text-center mb-16">
        <h2 class="text-xs font-bold text-accent uppercase tracking-[0.3em] mb-4">Investment Protocol</h2>
        <p class="text-3xl font-bold text-text mb-4">Transparent Pricing for Serious Results</p>
        <p class="text-muted">{offer.disclaimer}</p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
        {offer.tiers.map((tier) => (
          <Panel className={`flex flex-col relative ${tier.highlight ? 'border-accent/40 bg-accent/5 ring-1 ring-accent/20' : 'border-white/5'}`}>
            {tier.highlight && (
              <div class="absolute -top-3 left-1/2 -translate-x-1/2 bg-accent text-bg text-[10px] font-bold uppercase tracking-widest px-3 py-1 rounded-full">
                Recommended
              </div>
            )}
            <div class="mb-8">
              <h3 class="text-lg font-bold text-text mb-2 uppercase tracking-widest">{tier.name}</h3>
              <div class="flex items-baseline gap-1 mb-4">
                <span class="text-4xl font-bold text-text">{tier.price}</span>
                <span class="text-muted text-sm capitalize">/{tier.period}</span>
              </div>
              <p class="text-sm text-muted leading-relaxed">{tier.description}</p>
            </div>
            
            <ul class="space-y-4 mb-10 flex-grow">
              {tier.features.map((feature) => (
                <li class="flex items-start gap-3 text-sm text-muted2">
                  <span class="text-accent">✓</span>
                  <span>{feature}</span>
                </li>
              ))}
            </ul>
            
            <a href="#quiz" class={`w-full text-center py-4 rounded-lg font-bold transition-all ${tier.highlight ? 'bg-accent text-bg hover:brightness-110' : 'bg-white/5 text-text hover:bg-white/10'}`}>
              {tier.cta}
            </a>
          </Panel>
        ))}
      </div>
    </Container>
  </section>

  <!-- Live Spots Remaining Section -->
  <section id="spots-remaining" class="py-12 border-y border-white/5 bg-panel/30">
    <Container>
      <div class="flex flex-col items-center">
        <div class="inline-flex items-center gap-4 px-6 py-3 rounded-full border border-accent/20 bg-accent/5 backdrop-blur-sm">
          <span class="flex h-2 w-2 relative">
            <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-accent opacity-75"></span>
            <span class="relative inline-flex rounded-full h-2 w-2 bg-accent"></span>
          </span>
          <span class="text-sm font-bold text-text uppercase tracking-widest leading-none">
            System Capacity: <span id="spots-count" class="text-accent">...</span> Spots Remaining
          </span>
        </div>
      </div>
    </Container>
  </section>

  <!-- FAQ Section -->
  <section id="faq" class="py-24">
    <Container>
      <div class="max-w-3xl mx-auto">
        <h2 class="text-xs font-bold text-accent uppercase tracking-[0.3em] mb-12 text-center">Inquiry Protocol</h2>
        <div class="space-y-4">
          <Panel className="border-white/5">
            <h3 class="font-bold text-text mb-3 uppercase tracking-tight text-sm italic">What data signals do you require?</h3>
            <p class="text-muted text-sm leading-relaxed">We focus on heart rate variability, sleep architecture, training volume, and metabolic markers. These provide the essential signals for protocol adjustment.</p>
          </Panel>
          <Panel className="border-white/5">
            <h3 class="font-bold text-text mb-3 uppercase tracking-tight text-sm italic">How is the 24-hour turnaround maintained?</h3>
            <p class="text-muted text-sm leading-relaxed">Our clinical analysts use a deterministic framework to review your audit signals immediately upon submission.</p>
          </Panel>
          <Panel className="border-white/5">
            <h3 class="font-bold text-text mb-3 uppercase tracking-tight text-sm italic">Is this a remote-only service?</h3>
            <p class="text-muted text-sm leading-relaxed">We support both London-based on-site tactical sessions and remote digital signal tracking globally.</p>
          </Panel>
        </div>
      </div>
    </Container>
  </section>

  </main>

  <!-- Footer -->
  <footer id="footer" class="py-12 border-t border-white/5 bg-bg">
    <Container>
      <div class="flex flex-col md:flex-row items-center justify-between gap-6">
        <p class="text-[11px] text-muted2 uppercase tracking-widest font-mono">
          &copy; 2026 PT Authority Hub. Clinical Performance Protocol.
        </p>
        <div class="flex gap-6">
          <a href="#" class="text-[11px] text-muted2 hover:text-accent uppercase tracking-widest font-mono transition-colors">Privacy</a>
          <a href="#" class="text-[11px] text-muted2 hover:text-accent uppercase tracking-widest font-mono transition-colors">Terms</a>
          <a href="#" class="text-[11px] text-muted2 hover:text-accent uppercase tracking-widest font-mono transition-colors">Status</a>
        </div>
      </div>
    </Container>
  </footer>

  <!-- Client-side script to fetch and display spots remaining -->
  <script>
    async function loadSpotsRemaining() {
      try {
        const response = await fetch('/spots.json');
        const data = await response.json();
        const spotsElement = document.getElementById('spots-count');
        if (spotsElement && data.spotsRemaining !== undefined) {
          spotsElement.textContent = data.spotsRemaining;
        }
      } catch (error) {
        console.error('Error loading spots data:', error);
        const spotsElement = document.getElementById('spots-count');
        if (spotsElement) {
          spotsElement.textContent = 'N/A';
        }
      }
    }
    
    // Load spots when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', loadSpotsRemaining);
    } else {
      loadSpotsRemaining();
    }
  </script>

</body>
</html>
